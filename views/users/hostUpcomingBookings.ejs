<% layout("./layouts/boilerplate") %>

<div class="container my-5">
  <h3 class="mb-4 text-primary fw-bold">
    <i class="fas fa-door-open me-2"></i>Guest Bookings
  </h3>

  <% if(bookings.length === 0){ %>
    <div class="alert alert-info rounded-4 shadow-sm">
      No bookings found.
    </div>
  <% } else { %>
    <div class="table-responsive shadow-sm rounded-4 overflow-hidden">
      <table class="table table-hover align-middle mb-0">
        <thead class="text-white" style="background: linear-gradient(90deg, #008cff, #00d4ff);">
          <tr>
            <th>Guest</th>
            <th>Property</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Total Price</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <% bookings.forEach(b => { %>
            <tr class="booking-row" style="cursor: pointer;" 
                onclick="window.location.href='/listings/<%= b.listing._id %>/booking/<%= b._id %>'">
              <td class="ps-3"><%= b.user.username %></td>
              <td>
                <div class="d-flex align-items-center gap-2">
                  <% if(b.listing.featuredImage){ %>
                    <img src="<%= b.listing.featuredImage.url %>" 
                         alt="property" class="rounded-2" 
                         style="width: 60px; height: 45px; object-fit: cover;">
                  <% } %>
                  <span class="fw-semibold"><%= b.listing.title %></span>
                </div>
              </td>
              <td><%= new Date(b.startDate).toLocaleDateString('en-IN', {day:'numeric', month:'short', year:'numeric'}) %></td>
              <td><%= new Date(b.endDate).toLocaleDateString('en-IN', {day:'numeric', month:'short', year:'numeric'}) %></td>
              <td class="fw-bold text-success">â‚¹<%= b.totalPrice.toLocaleString("en-IN") %></td>
              <td class="<%= b.status === 'confirmed' ? 'text-success' : b.status === 'pending' ? 'text-warning' : 'text-danger' %> fw-semibold">
                <%= b.status.charAt(0).toUpperCase() + b.status.slice(1) %>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  <% } %>
</div>

<style>
.booking-row {
  transition: all 0.25s ease;
}
.booking-row:hover {
  background: linear-gradient(90deg, #f0f8ff, #e0f0ff);
  transform: scale(1.01);
}
.table td, .table th {
  vertical-align: middle;
}
.table img {
  border-radius: 0.375rem;
}
</style>
